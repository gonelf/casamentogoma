<!DOCTYPE HTML>
<html lang="pt" dir="ltr">
<head>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

  <script src="./cookie.js"></script>
  <script src="./airtable.js"></script>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
  <title>Mariana & Gonçalo</title>
  <meta name="description" content="Cátia e José – Save the Date">
  <meta name="author" content="GoMa Studios">
  <link rel="stylesheet" href="general.css">
  <link rel="stylesheet" href="main.css">
  <link rel="shortcut icon" href="img/favicon-2.ico" type="image/x-icon">
  <link rel="stylesheet" href="progress-bar.css" />
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script src="animations.js"></script>
  <script src="progress-bar.js"></script>
</head>
  <body>
    <div class="wrapper">
      <section id="presenca" class="container">
        <img src="img/planta-top-menu.png" alt="" class="header-plant">

        <div class="sidebar">
          <nav id="menu">

            <h6>Menu</h6>
            <a href="#presenca" id="#presenca" class="menu-items active">A tua presença</a>
            <a href="#localizacao" id="#localizacao" class="menu-items">Localização e Agenda</a>
            <a href="#faqs" id="#faqs" class="menu-items">Perguntas frequentes</a>
            <a href="#convite" id="#convite" class="menu-items">O teu convite</a>
            <a href="#contactos" id="#contactos" class="menu-items">Contactos</a>
            <a href="gifts.html" id="#gifts" class="menu-items">Presentes</a>
            <a href="index.html" class="logout">Sair</a>
          </nav>
        </div>

        <div class="content" id="top">
          <div class="header-left" >
            <div class="header-title">
              <h1 class="calligraphy">Mariana & Gonçalo</h1>
              <p>28 &middot; 10 &middot; 2023</p>
            </div>
            <img src="img/monograma.svg" alt="C&J" class="header-monograma">
            <a href="#" class="mobile-menu">Menu</a>
          </div>

          <h2 class="hello" id="welcome">Olá, [FirstName].</h2>

          <section id="gifts_container" class="page-section">

          </section>

          <script type="text/javascript">
            getGifts(function(data){
              console.log(data.records);
              var gifts = "";
              data.records.forEach((entry, i) => {
                var gift = entry.fields;
                var contributors = gift.contributors.join(", ");
                let contributions = 0;
                gift.contributions.map(x => contributions += x);
                let percent = Math.round(contributions*100/gift.value);
                var g = `
                <div id="${entry.id}" style="display:flex;">
                  <div id="left" >
                    <img src="${gift.images[0].url}" />
                  </div>
                  <div id="right" style="padding-left:20px;">
                    <h1>${gift.title}</h1>
                    <div class="progress-bar">
                      <div class="progress"
                      data-percent="${percent}"
                      data-color="green">
                      <span>${percent}%</span>
                      </div>
                    </div>
                    <h2>Preço: €${gift.value}</h2>
                    <h2>Contribuições: €${contributions}</h2>
                    <span>${contributors}</span>
                    <button type="button" name="button" class="contribute" gift_id="${gift.ID}" gifts_id="${entry.id}">Contribuir</button>
                  </div>
                </div>`;
                $("#gifts_container").append(g);
                $(".progress-bar").ProgressBar();

              });
            });

          </script>

          <section id="contactos" class="page-section">
            <h3>Contactos</h3>
            <p>Ficaste com alguma dúvida ou precisas de ajuda com algo? Fica à vontade para nos contactares, caso necessites.</p>
            <div class="contactos">
              <div class="contacto-noiva">
                <p class="noiva">Cátia</p>
                <a href="tel:+351917044614">917 044 614</a>
              </div>
              <div class="monograma">
                <img src="img/monograma.svg" alt="C&J">
              </div>
              <div class="contacto-noivo">
                <p class="noivo">José</p>
                <a href="tel:+351916086744">916 086 744</a>
              </div>
            </div>
          </section>


          <p class="signature">Made with ♥ by GoMa, 2021.</p>
        </div>
      </section>
      <footer>
        <img src="img/planta-top-right.png" alt="" class="footer-plant">
      </footer>

      <div class="modal-overlay" id="modal-loading">
        <div class="modal-card modal-loading">
          <img id="loading" src="img/loading.gif" />
          <p class="loading-txt">A verificar a lista de convidados...</p>
        </div>
      </div>

      <div class="modal-overlay" id="modal-overlay">
        <div class="modal-card" id="modal-card">
          <h2 class="modal-title"></h2>
          <a href="#" id="close"><img src="img/close.svg" alt="Fechar"></a>

          <form class="_form_" action="index.html" method="post" id="contribution" name="contribution" style="display:block;">
            <div class="form-container">
              <div class="form-field other-fields">
                <label for="cont_value" class="form-label">Contribuição</label>
                <input type="text" id="amount" name="amount" value="" placeholder="">
              </div>
            </div>
            <div class="button-container">
              <button type="submit" name="contribution" class="btn-gold btn-form">Confirmar</button>
            </div>

            <!-- <input type="hidden" id="id" value="" /> -->
            <input type="hidden" id="user_id" name="user_id" value="" />
            <input type="hidden" id="confirmed" name="confirmed" value="false">
            <input type="hidden" id="gift_id" name="gift_id" value="">
            <input type="hidden" id="gifts" name="gifts" value="">
          </form>

        </div>
      </div>

    </div>

    <script src="./scripts.js"></script>
  </body>
</html>
